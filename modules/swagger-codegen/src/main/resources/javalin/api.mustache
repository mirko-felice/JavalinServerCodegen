package {{package}};

{{#imports}}//import {{import}};
{{/imports}}
import io.javalin.Javalin;
import io.javalin.http.Context;
import java.util.*;

public class {{classname}} {

    private final String basePath;

    public {{classname}}(final String basePath) {
        this.basePath = Objects.requireNonNull(basePath);
    }

    public void registerRoutes(Javalin server) {
    {{#operations}}
    {{#operation}}
        server.{{#lowercase}}{{httpMethod}}{{/lowercase}}(this.basePath + "{{path}}".replace("{",":").replace("}",""), this::{{operationId}});
    {{/operation}}
    {{/operations}}
    }
    {{#operations}}{{#operation}}{{#isDeprecated}}@Deprecated{{/isDeprecated}}
    public void {{#operationId}}{{operationId}}{{/operationId}}{{^operationId}}{{#lowercase}}{{httpMethod}}{{/lowercase}}{{path}}{{/operationId}}(Context context) {
        // Path params
        {{#pathParams}}
        {{dataType}} {{baseName}} = context.pathParam("{{baseName}}", {{dataType}}.class).get();
        {{/pathParams}}

        // Query params
        {{#queryParams}}
        {{dataType}} {{baseName}} = context.queryParam("{{baseName}}", {{dataType}}.class{{#defaultValue}}, "{{defaultValue}}"{{/defaultValue}}).get{{^required}}OrNull{{/required}}();
        {{/queryParams}}

        // Form params
        {{#formParams}}
        {{dataType}} {{baseName}} = context.formParam("{{baseName}}", {{dataType}}.class{{#defaultValue}}, "{{defaultValue}}"{{/defaultValue}}).get{{^required}}OrNull{{/required}}();
        {{/formParams}}

        // Headers
        {{#headerParams}}
        {{dataType}} {{baseName}} = context.formParam("{{baseName}}", {{dataType}}.class{{#defaultValue}}, "{{defaultValue}}"{{/defaultValue}}).get{{^required}}OrNull{{/required}}();
        {{/headerParams}}

        context.contentType("{{#produces}}{{mediaType}}{{#hasMore}}; {{/hasMore}}{{/produces}}");
        {{#responses}}
        {{#schema}}
        //context.result(new CompletableFuture<{{dataType}}>());
        {{/schema}}
        {{/responses}}
    }
    {{/operation}}
    {{/operations}}
}